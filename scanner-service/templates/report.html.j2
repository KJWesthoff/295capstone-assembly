
<!doctype html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>{{ spec.title }} â€“ VentiAPI Report</title>
  <style>
    body { font-family: system-ui, Arial, sans-serif; margin: 24px; }
    .header { display:flex; justify-content:space-between; align-items:baseline; }
    .badge { padding: 2px 8px; border-radius: 16px; font-size: 12px; }
    .Critical{ background:#8b0000; color:#fff; }
    .High{ background:#b22222; color:#fff; }
    .Medium{ background:#ff8c00; color:#000; }
    .Low{ background:#ffd700; color:#000; }
    .Info{ background:#ccc; color:#000; }
    table { border-collapse: collapse; width: 100%; }
    th, td { border-bottom: 1px solid #eee; padding: 10px; text-align: left; vertical-align: top; }
    pre {background: #1e1e1e; color: #dcdcdc; padding: 10px; border-radius: 6px; overflow-x: auto; font-family: "Courier New", monospace; font-size: 13px;line-height: 1.4;}
    code {
    color: inherit;
    background: none;}
    .muted { color:#666; }
  </style>
</head>
<body>
  <div class="header">
    <h1>VentiAPI Report</h1>
    <div class="muted">{{ spec.title }} v{{ spec.version }}</div>
  </div>

  <p><strong>Servers:</strong> {{ spec.servers|join(', ') }}</p>

  <h2>Findings ({{ findings|length }})</h2>
  <table>
    <thead>
      <tr><th>Rule</th><th>Endpoint</th><th>Description</th><th>Severity</th></tr>
    </thead>
    <tbody>
    {% for f in findings %}
      <tr>
        <td><strong>{{ f.rule }}</strong><br/><span class="muted">{{ f.title }}</span></td>
        <td><code>{{ f.method }} {{ f.endpoint }}</code></td>
        <td>
          <div>{{ f.description }}</div>
          {% if f.evidence %}
            <details>
              <summary>Evidence</summary>
              <pre><code class="language-json">{{ f.evidence | tojson(indent=2) }}</code></pre>
            </details>
          {% endif %}
        </td>
        <td><span class="badge {{ f.severity }}">{{ f.severity }} ({{ f.score }})</span></td>
      </tr>
    {% endfor %}
    </tbody>
  </table>

  {% if findings|length == 0 %}
    <p>No issues found by active probes (within the configured safety limits). Consider enabling <code>--fuzz-auth</code> and <code>--dangerous</code> for deeper testing.</p>
  {% endif %}
</body>
</html>
